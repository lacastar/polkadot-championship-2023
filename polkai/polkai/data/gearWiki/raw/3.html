{"title":"Gear Documentation Portal","softTitle":"Gear Documentation Portal","date":null,"author":[],"publisher":null,"copyright":null,"description":"This guide provides a general overview of running smart contracts on the networks powered by Gear Protocol (such as the Vara Network). It guides you through how to write a smart contract, compile it to Wasm and deploy it to the Gear network.","lang":"en","canonicalLink":"https://wiki.gear-tech.io/docs/getting-started-in-5-minutes","tags":[],"image":"https://wiki.gear-tech.io/img/ogimage.jpg","videos":[],"links":[{"text":"Vara Network","href":"https://vara-network.io/"},{"text":"Gear Academy&apos;s","href":"https://academy.gear.foundation/"},{"text":"Gear Smart Contract Developer","href":"https://academy.gear.foundation/course/tamagotchi"},{"text":"Rustup","href":"https://rustup.rs/"},{"text":"Build Tools for Visual Studio","href":"https://visualstudio.microsoft.com/downloads/?q=build+tools"},{"text":"idea.gear-tech.io","href":"https://idea.gear-tech.io"},{"text":"https://polkadot.js.org/extension/","href":"https://polkadot.js.org/extension/"},{"text":"idea.gear-tech.io","href":"https://idea.gear-tech.io"},{"text":"this article on Smart Contracts","href":"/docs/developing-contracts/introduction"}],"text":"This guide provides a general overview of running smart contracts on the networks powered by Gear Protocol (such as the Vara Network). It guides you through how to write a smart contract, compile it to Wasm and deploy it to the Gear network.\n\nAttention developers! Want to take your blockchain development skills to the next level? Join Gear Academy's free course, \"Gear Smart Contract Developer.\" In this comprehensive course, you'll learn the ins and outs of developing on the Gear Protocol, from deploying programs onto the blockchain and interacting with them, to testing your programs on the Gear Network. You'll also gain hands-on experience navigating the @gear-js library for interacting with contracts on the client side and developing real-world applications, including contracts and frontends. Don't miss this opportunity to become a pro Gear blockchain developer. Enroll now in Gear Academy's \"Gear Smart Contract Developer\" course!\n\nLinux users should generally install GCC and Clang, according to their distributionâ€™s documentation.\n\nFor example, on Ubuntu use:\n\nOn macOS, you can get a compiler toolset by running:\n\nMake sure you have installed all the tools required to build a smart-contract in Rust. Rustup will be used to get Rust compiler ready:\n\nNow, let's install a nightly version of the toolchain with rustup, since Gear uses the most up-to-date features rustup provides. We use nightly-2023-09-18 as it is the latest version that is compatible with Gear.\n\nAs we will be compiling our Rust smart contract to Wasm, we will need a Wasm compiler. Let's add it to the toolchain.\n\nAlso, you need to install the wasm-proc utility that optimizes compiled Wasm to be more compact.\n\nNote: If you use Windows, download and install Build Tools for Visual Studio.\n\nFor your convenience, it is recommended that you create a dedicated directory for everything Gear-related. The rest of the article will assume that you are using the paths suggested. Type to create a folder in your home directory:\n\nThe next step would be to build a Rust library for our contract:\n\nNow, your gear/contracts directory tree should look like this:\n\nIt's time to write some code. Open counter with your favorite editor. For VS Code editor type:\n\nIn the counter folder, configure Cargo.toml for our contract to be properly built:\n\nReplace the default contents of lib.rs in the counter folder with the code for our first smart-contract.\n\nThis simple smart-contract accepts inc, dec, and get commands. Open src/lib.rs in your editor and paste the following code:\n\n#![no_std]use gstd::{msg, prelude::*};static mut COUNTER: i32 = 0;#[no_mangle]extern \"C\" fn handle() {    let command = msg::load_bytes().expect(\"Invalid message\");    let mut counter = unsafe { COUNTER };    match command.as_slice() {        b\"inc\" => counter += 1,        b\"dec\" => counter -= 1,        b\"get\" => {            msg::reply_bytes(format!(\"{counter}\"), 0).expect(\"Unable to reply\");        }        _ => (),    }    unsafe { COUNTER = counter };}\n\nNow compile the smart-contract to Wasm using cargo:\n\nThis command is quite verbose, so we can create cargo config and Rust toolchain override files to make it shorter. Create a .cargo/config.toml file in the counter directory with the following contents:\n\nAnd create a rust-toolchain.toml file in the counter directory with the following contents:\n\nNow you can build your smart-contract with a single command:\n\nIf everything goes well, your working directory should now have a target directory that looks like this:\n\nThe last preparation step is to optimize the Wasm binary using wasm-proc:\n\nA new Wasm file will be created:\n\nNow the target/wasm32-unknown-unknown/release directory contains two required Wasm binaries:\n\ncounter.wasm is the output Wasm binary built from source files\n\ncounter.opt.wasm is the optimized Wasm aimed to be uploaded to the blockchain\n\nGear provides a demo application that implements all of the possibilities of interaction with smart-contracts in Gear networks, available at idea.gear-tech.io.\n\nDownload the Polkadot extension for your browser via https://polkadot.js.org/extension/. This extension manages accounts and allows the signing of transactions with those accounts. It is a secure tool that allows injecting your accounts into any Substrate-based dapp. It does not perform wallet functions, e.g send funds.\n\nMake sure you save your 12-word mnemonic seed securely.\n\nSelect the network that will be used for this account - choose \"Allow to use on any chain\". Provide any name to this account and password and click \"Add the account with the generated seed\" to complete account registration.\n\nGo to idea.gear-tech.io. You will be prompted to grant access to your account for Gear Tech application, click \"Yes, allow this application access\".\n\nMake sure you are connected to the Vara Network Testnet. The network name is on the bottom left corner of the page.\n\nYou may switch the network by clicking on the network name.\n\nClick the Connect button on the top-right to select an account that will be connected to Gear Tech.\n\nIn accordance with the Actor model, smart contracts are uploaded to a network via messages. Gear node charges a gas fee during message processing. Your account balance needs to have enough funds to upload a smart-contract to the TestNet. Click the following button to get the test balance:\n\nA notification about successful balance replenishment will appear after passing captcha at the bottom of the window. You can also see the current account balance next to the account name in the upper right corner.\n\nWhen your account balance is sufficient, click the  and navigate to the .opt.wasm file we have pointed to above.\n\nSpecify the program Name and click  button. The Gas limit will be set automatically. Now click the  button.\n\nSign the program uploading the transaction to the Gear network. Also, sign the program and metadata upload to the Gear demo environment so you could work with the program. It is recommended to set the checkbox Remember my password for the next 15 minutes for your convenience.\n\nOnce your program is uploaded, head to the Programs section and find your program.\n\nNow, try sending your newly uploaded program a message to see how it responds! Click the  button.\n\nIn the Payload field of the opened dialog type 0x696E63 (this is inc encoded in hex). Click  button, the Gas limit will be set automatically. Now click the  button.\n\nSign the message sending transaction as it is shown in step 3 of the section Upload Program.\n\nAfter your message has been successfully processed, you are to see correspondent log messages:\n\nNow you have sent an increment command to the program. After processing the counter will be incremented to 1.\n\nRepeat step 2 with 0x676574 payload (this is get command). This will send a get command to the program.\n\nPress the  button to enter the mailbox and find the reply.\n\nThe reply is in the mailbox for a limited time depending on the gas limit. If you don't see the reply, try resending the 0x676574 (get) message with the gas limit increasing and go to the mailbox immediately after sending the message.\n\nFor more info about writing smart contracts for Gear and the specifics behind the smart contract implementation, refer to this article on Smart Contracts."}